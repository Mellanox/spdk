### Test 1

**IO pacing**: `none`

**Configuration**: `config_null_1`

**Initiator**: `fio+SPDK`

| QD         | BW         | WIRE BW    | AVG LAT, us     | BW STDDEV  | L3 Hit Rate     | Bufs in-flight (MiB)      |
|------------|------------|------------|-----------------|------------|-----------------|---------------------------|
| 32         | 129.3      | 137.8114   | 635.6           | 14.9       | 99.2            | 64.0 (8.0)                |
| 64         | 174.1      | 188.4487   | 770.5           | 2.9        | 1.2             | 128.0 (16.0)              |
| 128        | 174.6      | 184.8292   | 1537.5          | 2.5        | .6              | 255.3 (31.9)              |
| 256        | 174.0      | 188.2049   | 3086.3          | 2.9        | .5              | 256.0 (32.0)              |
| 1024       | 174.0      | 181.6536   | 6171.4          | 3.0        | .5              | 255.6 (31.9)              |
| 2048       | 174.3      | 182.9162   | 6159.4          | 2.5        | .5              | 255.3 (31.9)              |

### Test 2

**IO pacing**: `none`

**Configuration**: `config_null_16`

**Initiator**: `fio+SPDK`

**Target CPU mask:** 0xF

| QD         | BW         | WIRE BW    | AVG LAT, us     | BW STDDEV  | L3 Hit Rate     | Bufs in-flight (MiB)      |
|------------|------------|------------|-----------------|------------|-----------------|---------------------------|
| 32         | 184.8      | 196.329    | 362.8           | .1         | 84.6            | 17.0 (2.1)                |
| 64         | 184.8      | 196.3332   | 725.7           | 0          | 78.8            | 84.6 (10.5)               |
| 128        | 184.8      | 196.3337   | 1451.7          | 0          | 77.2            | 187.6 (23.4)              |
| 256        | 184.8      | 196.3346   | 2904.2          | .1         | 59.8            | 398.6 (49.8)              |
| 1024       | 184.7      | 196.3351   | 11342.3         | .2         | 52.5            | 860.6 (107.5)             |
| 2048       | 184.5      | 196.3348   | 13496.5         | .7         | 52.2            | 949.0 (118.6)             |

### Test 4

**IO pacing**: `Limit number of SPDK buffers to 96`

**Configuration**: `NUM_SHARED_BUFFERS=96 config_null_16`

**Initiator**: `fio+SPDK`

**Target CPU mask:** 0xF

| QD         | BW         | WIRE BW    | AVG LAT, us     | BW STDDEV  | L3 Hit Rate     | Bufs in-flight (MiB)      |
|------------|------------|------------|-----------------|------------|-----------------|---------------------------|
| 32         | 184.8      | 196.3354   | 362.8           | .1         | 97.4            | 17.3 (2.1)                |
| 64         | 184.8      | 196.332    | 725.8           | .1         | 94.3            | 38.3 (4.7)                |
| 128        | 184.8      | 196.3329   | 1451.8          | .1         | 93.0            | 56.3 (7.0)                |
| 256        | 184.8      | 196.3356   | 2903.7          | 0          | 92.4            | 52.0 (6.5)                |
| 1024       | 179.4      | 196.3353   | 11982.5         | .3         | 93.8            | 66.0 (8.2)                |
| 2048       | 184.7      | 196.336    | 23248.6         | .8         | 89.2            | 96.0 (12.0)               |

### Test 5

**IO pacing**: `Limit number of SPDK buffers to 96`

**Configuration**: `NUM_SHARED_BUFFERS=96 BUF_CACHE_SIZE=6 config_nvme`

**Initiator**: `fio+SPDK`

**Target CPU mask:** 0xF

| QD         | BW         | WIRE BW    | AVG LAT, us     | BW STDDEV  | L3 Hit Rate     | Bufs in-flight (MiB)      |
|------------|------------|------------|-----------------|------------|-----------------|---------------------------|
| 32         | 180.9      | 191.7578   | 370.6           | .6         | 99.4            | 32.0 (4.0)                |
| 64         | 183.3      | 196.2312   | 731.6           | 1.3        | 88.6            | 47.6 (5.9)                |
| 128        | 183.2      | 196.2073   | 1464.5          | 1.4        | 88.3            | 53.6 (6.7)                |
| 256        | 183.2      | 196.1018   | 2929.6          | 1.4        | 88.4            | 70.0 (8.7)                |
| 1024       | 183.0      | 196.0663   | 11733.6         | 1.3        | 88.4            | 66.3 (8.2)                |
| 2048       | 174.2      | 195.8848   | 24271.7         | 3.2        | 86.7            | 76.3 (9.5)                |

### Test 6

Stability tests. Check variation of results between multiple runs for
different queue depths.

**IO pacing**: `Limit number of SPDK buffers to 96`

**Configuration**: `NUM_SHARED_BUFFERS=96 BUF_CACHE_SIZE=6 config_nvme`

**Initiator**: `fio+SPDK`

| QD         | BW         | WIRE BW    | AVG LAT, us     | BW STDDEV  | L3 Hit Rate     | Bufs in-flight (MiB)      |
|------------|------------|------------|-----------------|------------|-----------------|---------------------------|
| 32         | 181.0      | 192.7453   | 370.4           | .6         | 99.4            | 31.0 (3.8)                |
| 32         | 180.9      | 192.7751   | 370.7           | .6         | 99.3            | 31.3 (3.9)                |
| 32         | 181.0      | 192.7179   | 370.5           | .6         | 99.2            | 31.0 (3.8)                |
| 32         | 180.8      | 191.7542   | 370.8           | .6         | 99.4            | 32.0 (4.0)                |
| 32         | 181.0      | 192.8969   | 370.4           | .6         | 99.4            | 32.0 (4.0)                |
| 32         | 180.8      | 192.8457   | 370.7           | .6         | 99.4            | 32.6 (4.0)                |
| 32         | 181.0      | 192.9574   | 370.4           | .6         | 99.4            | 34.0 (4.2)                |
| 32         | 180.8      | 192.8777   | 370.7           | .7         | 99.3            | 32.0 (4.0)                |
| 32         | 180.7      | 192.1953   | 371.0           | .9         | 99.4            | 33.6 (4.2)                |
| 32         | 180.8      | 192.6212   | 370.8           | .7         | 99.4            | 32.3 (4.0)                |
| 256        | 183.1      | 196.1463   | 2930.8          | 1.4        | 89.4            | 60.0 (7.5)                |
| 256        | 183.1      | 196.1126   | 2931.0          | 1.4        | 87.3            | 53.0 (6.6)                |
| 256        | 183.2      | 196.0903   | 2929.7          | 1.4        | 88.0            | 55.6 (6.9)                |
| 256        | 183.0      | 196.1878   | 2932.1          | 1.4        | 88.0            | 76.6 (9.5)                |
| 256        | 183.0      | 196.1691   | 2933.1          | 1.5        | 87.4            | 61.0 (7.6)                |
| 256        | 183.1      | 196.0661   | 2930.4          | 1.5        | 88.9            | 58.6 (7.3)                |
| 256        | 183.0      | 196.1019   | 2932.5          | 1.5        | 88.2            | 74.6 (9.3)                |
| 256        | 183.0      | 195.978    | 2931.9          | 1.5        | 87.2            | 64.3 (8.0)                |
| 256        | 183.1      | 196.0122   | 2930.5          | 1.3        | 88.5            | 64.3 (8.0)                |
| 256        | 183.1      | 196.1323   | 2930.7          | 1.4        | 88.1            | 69.0 (8.6)                |
| 1024       | 182.7      | 196.1498   | 11752.6         | 1.6        | 87.3            | 70.0 (8.7)                |
| 1024       | 182.5      | 195.8226   | 11763.6         | 1.6        | 86.8            | 68.6 (8.5)                |
| 1024       | 182.6      | 196.1195   | 11755.7         | 1.6        | 87.7            | 80.6 (10.0)               |
| 1024       | 182.3      | 195.8221   | 11776.0         | 1.7        | 86.8            | 74.3 (9.2)                |
| 1024       | 170.8      | 195.2426   | 12570.1         | 7.7        | 86.0            | 85.3 (10.6)               |
| 1024       | 182.6      | 195.8331   | 11760.9         | 1.6        | 87.9            | 70.0 (8.7)                |
| 1024       | 183.0      | 196.1179   | 11736.0         | 1.4        | 88.0            | 63.6 (7.9)                |
| 1024       | 182.8      | 196.1604   | 11746.3         | 1.4        | 88.8            | 63.0 (7.8)                |
| 1024       | 179.2      | 196.0784   | 12215.6         | 3.1        | 87.2            | 69.3 (8.6)                |
| 1024       | 182.9      | 195.9947   | 11736.5         | 1.3        | 90.4            | 67.3 (8.4)                |
| 2048       | 165.0      | 195.6752   | 23453.7         | 7.7        | 87.0            | 69.3 (8.6)                |
| 2048       | 114.1      | 11.7483    | 36052.1         | 20.4       | 90.5            | 61.3 (7.6)                |
| 2048       | 169.9      | 195.7072   | 25239.6         | 8.2        | 86.3            | 72.3 (9.0)                |
| 2048       | 170.3      | 195.7915   | 25208.8         | 6.9        | 88.0            | 80.6 (10.0)               |
| 2048       | 159.7      | 195.8313   | 24719.4         | 10.2       | 87.8            | 67.0 (8.3)                |
| 2048       | 182.8      | 195.9518   | 23482.9         | 1.8        | 88.6            | 66.6 (8.3)                |
| 2048       | 159.5      | 196.1289   | 24218.8         | 8.9        | 97.3            | 68.6 (8.5)                |
| 2048       | 156.2      | 196.1796   | 22841.8         | 13.1       | 97.3            | 74.6 (9.3)                |
| 2048       | 171.9      | 195.8958   | 24800.2         | 7.5        | 86.3            | 77.3 (9.6)                |
| 2048       | 152.1      | 196.0882   | 26380.5         | 10.3       | 88.0            | 56.3 (7.0)                |

### Test 7

Check performance effect of number of target cores.

**IO pacing**: `Limit number of SPDK buffers to 96`

**Configuration**: `NUM_SHARED_BUFFERS=96 BUF_CACHE_SIZE=$((num_buffers/num_cores)) config_nvme`

**Initiator**: `fio+SPDK`

Target cores 16 (0xFFFF). Buffer cache size 6

| QD         | BW         | WIRE BW    | AVG LAT, us     | BW STDDEV  | L3 Hit Rate     | Bufs in-flight (MiB)      |
|------------|------------|------------|-----------------|------------|-----------------|---------------------------|
| 32         | 153.2      | 186.9358   | 437.7           | 15.5       | 99.5            | 12.0 (1.5)                |
| 64         | 172.6      | 193.1896   | 777.2           | 10.4       | 96.0            | 31.0 (3.8)                |
| 128        | 173.9      | 194.2205   | 1542.7          | 9.1        | 96.2            | 33.3 (4.1)                |
| 256        | 176.5      | 194.7853   | 3041.5          | 6.9        | 95.5            | 32.0 (4.0)                |
| 1024       | 156.5      | 195.4675   | 12362.3         | 15.8       | 91.8            | 38.3 (4.7)                |
| 2048       | 119.9      | 0          | 27286.3         | 19.4       | 92.1            | 60.0 (7.5)                |
| 32         | 180.8      | 192.6718   | 370.9           | .8         | 99.4            | 34.0 (4.2)                |
| 64         | 183.0      | 196.1263   | 733.0           | 1.6        | 88.7            | 53.3 (6.6)                |
| 128        | 183.0      | 195.8787   | 1466.2          | 1.6        | 89.0            | 59.6 (7.4)                |
| 256        | 182.8      | 195.9895   | 2935.5          | 1.6        | 88.8            | 68.3 (8.5)                |
| 1024       | 182.3      | 195.9019   | 12142.4         | 1.8        | 87.4            | 82.0 (10.2)               |
| 2048       | 166.1      | 195.6884   | 22845.2         | 10.9       | 87.7            | 77.6 (9.7)                |
| 32         | 181.0      | 192.5283   | 370.5           | .6         | 99.4            | 32.6 (4.0)                |
| 64         | 183.2      | 196.1701   | 732.2           | 1.4        | 88.6            | 48.0 (6.0)                |
| 128        | 183.0      | 195.8798   | 1466.0          | 1.5        | 87.7            | 48.3 (6.0)                |
| 256        | 183.2      | 196.1189   | 2930.1          | 1.4        | 89.6            | 52.3 (6.5)                |
| 1024       | 183.0      | 196.2159   | 11734.6         | 1.3        | 89.4            | 58.6 (7.3)                |
| 2048       | 182.6      | 196.1293   | 23509.2         | 1.8        | 87.2            | 67.0 (8.3)                |
| 32         | 179.2      | 190.7738   | 374.0           | .7         | 99.4            | 31.3 (3.9)                |
| 64         | 183.9      | 196.2118   | 729.4           | 1.0        | 92.2            | 48.3 (6.0)                |
| 128        | 184.3      | 196.2666   | 1455.6          | .5         | 93.5            | 48.0 (6.0)                |
| 256        | 184.5      | 196.2601   | 2908.8          | .3         | 95.1            | 48.0 (6.0)                |
| 1024       | 184.5      | 196.2306   | 11635.5         | .2         | 95.4            | 48.0 (6.0)                |
| 2048       | 184.5      | 196.1993   | 23277.8         | .1         | 96.3            | 48.0 (6.0)                |
| 32         | 166.7      | 177.5174   | 402.2           | .5         | 99.5            | 64.0 (8.0)                |
| 64         | 177.2      | 189.0323   | 757.0           | 3.1        | 92.8            | 96.0 (12.0)               |
| 128        | 173.8      | 184.4002   | 1544.0          | 1.3        | 93.2            | 96.0 (12.0)               |
| 256        | 148.8      | 169.6696   | 3606.2          | 6.7        | 92.4            | 96.0 (12.0)               |
| 1024       | 66.5       | 21.5698    | 34186.5         | 16.9       | 92.9            | 96.0 (12.0)               |
| 2048       | |          | 96.0       | 91.2            | |          |                 |  ()                       |

### Test 8

Check performance effects of buffer cache size.

**IO pacing**: `Limit number of SPDK buffers to 96`

**Configuration**: `NUM_SHARED_BUFFERS=96 BUF_CACHE_SIZE=$buf_cache_size config_nvme`

**Initiator**: `fio+SPDK`

Buffer cache size 6.

| QD         | BW         | WIRE BW    | AVG LAT, us     | BW STDDEV  | L3 Hit Rate     | Bufs in-flight (MiB)      |
|------------|------------|------------|-----------------|------------|-----------------|---------------------------|
| 32         | 153.3      | 186.9712   | 437.5           | 15.6       | 99.5            | 11.0 (1.3)                |
| 64         | 169.2      | 192.4679   | 792.9           | 11.9       | 96.7            | 28.0 (3.5)                |
| 128        | 172.0      | 192.624    | 1559.8          | 10.8       | 96.0            | 36.0 (4.5)                |
| 256        | 176.9      | 194.9639   | 3034.1          | 6.6        | 95.7            | 40.0 (5.0)                |
| 1024       | 155.9      | 195.5284   | 12814.8         | 9.9        | 94.8            | 29.0 (3.6)                |
| 2048       | 126.2      | 192.0534   | 23192.4         | 16.7       | 90.9            | 58.3 (7.2)                |
| 32         | 165.1      | 187.1082   | 406.1           | 11.8       | 99.5            | 35.3 (4.4)                |
| 64         | 172.3      | 194.7679   | 778.4           | 10.3       | 96.4            | 43.0 (5.3)                |
| 128        | 175.4      | 194.5688   | 1530.0          | 8.2        | 97.2            | 58.0 (7.2)                |
| 256        | 176.4      | 195.7395   | 3043.4          | 7.0        | 97.3            | 71.6 (8.9)                |
| 1024       | 171.7      | 192.8975   | 12885.2         | 8.4        | 96.9            | 60.3 (7.5)                |
| 2048       | 167.6      | 194.4482   | 23841.5         | 8.2        | 96.1            | 52.0 (6.5)                |
| 32         | 163.4      | 186.8523   | 410.4           | 12.2       | 99.4            | 32.3 (4.0)                |
| 64         | 172.0      | 192.6385   | 779.8           | 10.8       | 96.1            | 59.0 (7.3)                |
| 128        | 174.6      | 194.3423   | 1536.7          | 8.8        | 95.4            | 58.3 (7.2)                |
| 256        | 175.3      | 194.3333   | 3062.2          | 8.8        | 95.6            | 63.0 (7.8)                |
| 1024       | 180.0      | 195.0608   | 12322.4         | 5.1        | 96.5            | 57.6 (7.2)                |
| 2048       | 177.7      | 195.4205   | 23782.3         | 5.7        | 96.5            | 64.0 (8.0)                |
| 32         | 163.9      | 186.6251   | 409.0           | 12.1       | 99.3            | 37.3 (4.6)                |
| 64         | 170.4      | 191.8494   | 787.1           | 11.1       | 97.4            | 30.0 (3.7)                |
| 128        | 164.4      | 182.1393   | 1631.7          | 7.8        | 97.9            | 62.0 (7.7)                |

### Test 10

Check performance effect of number of data buffers with 4 cores. All
buffers are shared equally between all threads at start with
`BufCacheSize` parameter.

**IO pacing**: `Limit number of SPDK buffers to 96`

**Configuration**: `NUM_SHARED_BUFFERS=$num_buffers BUF_CACHE_SIZE=$((num_buffers/4)) config_nvme`

**Initiator**: `fio+SPDK`

**CPU mask**: 0xF

| Num buffers | Buf cache | QD         | BW         | WIRE BW    | AVG LAT, us     | BW STDDEV  | L3 Hit Rate     | Bufs in-flight (MiB)      |
|-------------|-----------|------------|------------|------------|-----------------|------------|-----------------|---------------------------|
| 128         | 32        | 256        | 139.2      | 146.5161   | 3854.6          | 3.2        | 65.1            | 89.3 (11.1)               |
| 128         | 32        | 1024       | 137.0      | 149.9497   | 15668.3         | 3.3        | 65.5            | 90.0 (11.2)               |
| 96          | 24        | 256        | 182.0      | 196.1142   | 2949.3          | 4.1        | 89.5            | 63.0 (7.8)                |
| 96          | 24        | 1024       | 183.0      | 195.909    | 11735.1         | 1.5        | 88.6            | 69.3 (8.6)                |
| 64          | 16        | 256        | 181.3      | 192.8647   | 2959.8          | .3         | 99.5            | 48.6 (6.0)                |
| 64          | 16        | 1024       | 167.0      | 178.5434   | 12858.3         | 4.9        | 99.4            | 39.6 (4.9)                |
| 48          | 12        | 256        | 157.4      | 166.9114   | 3409.5          | 1.4        | 99.5            | 38.0 (4.7)                |
| 48          | 12        | 1024       | 146.9      | 155.3006   | 14619.3         | 2.4        | 99.4            | 33.0 (4.1)                |
| 44          | 11        | 256        | 151.3      | 159.5022   | 3547.7          | 3.5        | 99.5            | 32.3 (4.0)                |
| 44          | 11        | 1024       | 140.1      | 148.4166   | 15330.6         | 2.8        | 99.4            | 31.6 (3.9)                |
| 40          | 10        | 256        | 141.1      | 150.4636   | 3804.3          | 2.1        | 99.5            | 32.3 (4.0)                |
| 40          | 10        | 1024       | 128.3      | 139.4802   | 16754.5         | 4.9        | 99.4            | 28.6 (3.5)                |
| 36          | 9         | 256        | 132.7      | 141.3987   | 4043.7          | 2.6        | 99.5            | 28.0 (3.5)                |
| 36          | 9         | 1024       | 124.2      | 130.5055   | 17292.0         | 3.4        | 99.4            | 26.0 (3.2)                |
| 32          | 8         | 256        | 121.9      | 129.0161   | 4402.5          | 2.6        | 99.5            | 26.0 (3.2)                |
| 32          | 8         | 1024       | 108.0      | 117.5969   | 19883.4         | 5.0        | 99.4            | 22.6 (2.8)                |
| 24          | 6         | 256        | 95.6       | 102.2675   | 5613.2          | 2.0        | 99.5            | 20.0 (2.5)                |
| 24          | 6         | 1024       | 86.9       | 93.4977    | 24717.3         | 3.9        | 99.4            | 18.0 (2.2)                |
| 16          | 4         | 256        | 65.6       | 69.5475    | 8182.5          | 1.4        | 99.4            | 13.6 (1.7)                |
| 16          | 4         | 1024       | 65.1       | 68.7459    | 32963.8         | 1.7        | 99.4            | 11.6 (1.4)                |

### Test 11

Split each NVMe disk into 3 partitions with SPDK split block device
and build delay block device on top of some partitions.

IO depth is shared equally between all disks. FIO runs 3 jobs with
queue depth of 85 or 341 each. This gives us total IO depth of 255 and
1023 per initiator respectively.

**IO pacing**: `Number of buffers`

**Configuration**: `config_nvme_split3_delay`

**Initiator**: `fio+SPDK`

**CPU mask**: 0xF

| Num buffers | Num delay bdevs | QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-------------|-----------------|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 96          | 0               | 85  | 182.4 | 196.2003 | 2931.2      | 1.4       | 94.4        | 57.6 (7.2)           |
| 96          | 0               | 341 | 172.7 | 196.2555 | 12424.5     | 2.7       | 93.8        | 44.6 (5.5)           |
| 96          | 16              | 85  | 157.4 | 171.0941 | 3398.7      | .4        | 93.6        | 75.0 (9.3)           |
| 96          | 16              | 341 | 136.1 | 161.4393 | 16238.9     | 2.9       | 92.5        | 81.0 (10.1)          |
| 96          | 32              | 85  | 109.4 | 116.0836 | 4886.2      | 1.5       | 88.2        | 75.0 (9.3)           |
| 96          | 32              | 341 | 112.3 | 111.87   | 19210.5     | 4.3       | 87.0        | 84.3 (10.5)          |
| 48          | 0               | 85  | 157.0 | 166.1663 | 3404.0      | .6        | 99.5        | 35.3 (4.4)           |
| 48          | 0               | 341 | 129.4 | 166.1863 | 17297.6     | 3.9       | 99.4        | 39.3 (4.9)           |
| 48          | 16              | 85  | 88.9  | 92.3295  | 6016.8      | 2.0       | 99.3        | 38.6 (4.8)           |
| 48          | 16              | 341 | 89.7  | 89.1863  | 24470.7     | 3.3       | 99.1        | 46.0 (5.7)           |
| 48          | 32              | 85  | 56.5  | 58.6304  | 9466.7      | 1.3       | 99.1        | 39.3 (4.9)           |
| 48          | 32              | 341 | 59.5  | 57.3809  | 36071.5     | 2.6       | 98.9        | 48.0 (6.0)           |
