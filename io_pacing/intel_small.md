# Small payload tests

All tests are run with 8 fio jobs per initiator if not explicitly
stated otherwise. Effective queue depth can be calculated as
`QD * num_jobs * num_initiators`, where `QD` is QD column in the tables
below, `num_jobs` is 8, `num_initiators` is 2.

Target CPU mask is 0xFFFF (16 cores) in all tests if not explictly
stated otherwise.

[4K payload](#4k-payload)

[8K payload](#8k-payload)

[16K payload](#16k-payload)

## 4k payload

### test_2_4k

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 173.4 | 189.5048 | 96.2        | .7        | 88.9        | 75.0 (9.3)           |
| 64  | 172.3 | 187.6894 | 194.4       | .7        | 88.2        | 171.0 (21.3)         |
| 128 | 169.2 | 183.9345 | 396.4       | .6        | 72.7        | 648.6 (81.0)         |
| 256 | 149.9 | 161.5662 | 894.6       | .5        | 36.3        | 1378.0 (172.2)       |
| 512 | 144.5 | 159.7459 | 1856.5      | .6        | 30.3        | 1599.6 (199.9)       |

### test_3_4k

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 117.5 | 129.6886 | 142.2       | .5        | 94.7        | 88.6 (11.0)          |
| 64  | 134.0 | 149.5614 | 249.8       | .5        | 93.9        | 345.6 (43.2)         |
| 128 | 129.9 | 144.0952 | 515.9       | .5        | 91.7        | 870.3 (108.7)        |
| 256 | 125.9 | 141.1244 | 1065.1      | .5        | 90.6        | 1398.6 (174.8)       |
| 512 | 124.9 | 137.2699 | 2147.4      | .5        | 90.0        | 1503.3 (187.9)       |

### test_4_4k

Num buffers 1536, buf cache size 96

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 173.4 | 189.7051 | 96.3        | .6        | 88.9        | 160.3 (20.0)         |
| 64  | 172.9 | 188.5671 | 193.7       | .6        | 88.2        | 335.3 (41.9)         |
| 128 | 169.8 | 186.0014 | 395.3       | .6        | 87.6        | 494.0 (61.7)         |
| 256 | 169.1 | 185.4054 | 794.6       | .5        | 87.7        | 552.6 (69.0)         |
| 512 | 167.1 | 182.8116 | 1611.2      | .6        | 87.5        | 547.0 (68.3)         |

### test_5_4k

Num buffers 1536, buf cache size 96

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 117.0 | 130.13   | 142.9       | .5        | 94.7        | 176.6 (22.0)         |
| 64  | 134.0 | 149.2701 | 249.9       | .5        | 94.0        | 349.6 (43.7)         |
| 128 | 129.8 | 144.5814 | 516.2       | .5        | 93.5        | 440.3 (55.0)         |
| 256 | 127.1 | 140.5292 | 1054.8      | .5        | 93.6        | 664.0 (83.0)         |
| 512 | 126.7 | 140.7007 | 2117.2      | .5        | 93.6        | 618.3 (77.2)         |

### test_7_4k

Num buffers 1536, buf cache size 1536/num_cores

| Tgt CPUs    | QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-------------|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 16 (0xFFFF) | 512 | 126.4 | 140.1972 | 2122.9      | .6        | 93.7        | 273.3 (1.0)          |
| 8 (0xFF)    | 512 | 59.4  | 65.4793  | 4512.1      | .1        | 94.5        | 829.0 (3.2)          |
| 4 (0xF)     | 512 | 26.2  | 28.8204  | 10214.7     | .1        | 94.1        | 794.0 (3.1)          |
| 2 (0x3)     | 512 | 10.6  | 11.7177  | 25098.2     | 0         | 85.4        | 1536.0 (6.0)         |
| 1 (0x1)     | 512 | 5.8   | 6.4283   | 46004.0     | 0         | 82.6        | 1536.0 (6.0)         |

### test_9_4k

Buffer cache size num_buffers/16

| Num buffers | QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-------------|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 4096        | 512 | 126.8 | 140.5537 | 2116.4      | .9        | 90.2        | 720.6 (2.8)          |
| 3072        | 512 | 124.8 | 139.1883 | 2149.3      | .7        | 92.1        | 512.0 (2.0)          |
| 2560        | 512 | 126.1 | 141.2409 | 2127.5      | .6        | 92.9        | 458.0 (1.7)          |
| 2048        | 512 | 127.4 | 143.8515 | 2106.3      | .6        | 93.5        | 373.6 (1.4)          |
| 1536        | 512 | 126.1 | 141.5201 | 2126.7      | .5        | 93.7        | 304.6 (1.1)          |
| 1024        | 512 | 121.5 | 134.2935 | 2208.3      | .7        | 94.0        | 184.6 (.7)           |
| 512         | 512 | 108.0 | 119.7071 | 2486.1      | .7        | 94.5        | 114.3 (.4)           |
| 256         | 512 | 86.9  | 94.8777  | 3089.8      | .6        | 94.6        | 56.3 (.2)            |

### test_13_4k

| Disk type        | QD | BW  | WIRE BW | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|------------------|----|-----|---------|-------------|-----------|-------------|----------------------|
| Null             | 1  | 2.7 | 3.6419  | 11.6        | .6        | 86.4        | 0 (0)                |
| NVMe             | 1  | .7  | 0.9753  | 43.5        | .1        | 99.4        | 0 (0)                |
| NVMe+split       | 1  | .7  | 0.9428  | 45.1        | .1        | 99.5        | 0 (0)                |
| NVMe+split+delay | 1  | 0   | 0.0335  | 1122.6      | 0         | 99.7        | .3 (0)               |

### test_14_4k

CPU mask 0xFFFF, num cores 16, credit size 32768, num buffers 131072, buf cache 8192

| Pacer period | QD   | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) | Pacer period, us |
|--------------|------|-------|----------|-------------|-----------|-------------|----------------------|------------------|
| 1425         | 256  | 102.4 | 113.0544 | 1309.4      | .6        | 93.9        | 161.3 (.6)           | 41.5             |
| 1425         | 2048 | 101.1 | 112.5174 | 3219.1      | .4        | 93.9        | 281.0 (1.0)          | 41.8             |
| 1500         | 256  | 101.5 | 112.4445 | 1321.9      | .4        | 94.0        | 234.6 (.9)           | 41.4             |
| 1500         | 2048 | 100.7 | 111.7812 | 3249.7      | .3        | 93.9        | 265.0 (1.0)          | 42.0             |

CPU mask , num cores 16, credit size 65536, num buffers 131072, buf cache 8192

| Pacer period | QD   | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) | Pacer period, us |
|--------------|------|-------|----------|-------------|-----------|-------------|----------------------|------------------|
| 2850         | 256  | 117.7 | 132.9176 | 1139.4      | .6        | 93.2        | 136.6 (.5)           | 77.9             |
| 2850         | 2048 | 116.5 | 131.1985 | 2782.2      | .9        | 92.9        | 366.3 (1.4)          | 78.0             |
| 3000         | 256  | 117.2 | 131.8745 | 1144.2      | .6        | 93.1        | 142.6 (.5)           | 78.3             |
| 3000         | 2048 | 117.1 | 129.1527 | 2962.9      | .9        | 92.8        | 507.6 (1.9)          | 78.4             |

## 8k payload

### test_2_8k

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 178.2 | 192.2713 | 187.8       | .8        | 93.0        | 84.3 (10.5)          |
| 64  | 175.9 | 190.2643 | 381.3       | .7        | 86.0        | 179.6 (22.4)         |
| 128 | 169.6 | 181.0389 | 790.8       | .6        | 36.4        | 958.3 (119.7)        |
| 256 | 159.3 | 176.0997 | 1683.6      | .5        | 20.6        | 1992.0 (249.0)       |
| 512 | 156.6 | 165.8057 | 3425.9      | .5        | 19.2        | 2034.3 (254.2)       |

### test_3_8k

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 176.8 | 191.037  | 189.3       | .7        | 96.8        | 84.0 (10.5)          |
| 64  | 175.8 | 190.1567 | 381.6       | .6        | 92.9        | 346.0 (43.2)         |
| 128 | 122.4 | 129.0789 | 1095.2      | .5        | 65.3        | 935.3 (116.9)        |
| 256 | 109.7 | 117.4811 | 2445.0      | .5        | 61.4        | 1964.0 (245.5)       |
| 512 | 104.4 | 114.5987 | 5138.2      | .4        | 58.7        | 1926.3 (240.7)       |

### test_4_8k

Num buffers 1536, buf cache size 96

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 174.3 | 188.268  | 192.2       | .7        | 93.1        | 82.3 (10.2)          |
| 64  | 176.0 | 190.2867 | 381.1       | .6        | 88.9        | 350.3 (43.7)         |
| 128 | 175.6 | 189.1558 | 764.4       | .5        | 68.0        | 612.6 (76.5)         |
| 256 | 173.1 | 187.4803 | 1549.6      | 1.2       | 61.2        | 708.3 (88.5)         |
| 512 | 172.9 | 185.2764 | 3109.3      | .7        | 61.9        | 875.6 (109.4)        |

### test_5_8k

Num buffers 1024, buf cache size 64

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 176.8 | 191.3817 | 189.3       | .8        | 96.8        | 84.0 (.6)            |
| 64  | 175.6 | 189.5904 | 382.0       | .7        | 96.0        | 166.3 (1.2)          |
| 128 | 175.2 | 189.4434 | 766.3       | .7        | 95.6        | 439.0 (3.4)          |
| 256 | 174.5 | 188.6292 | 1539.5      | .6        | 95.4        | 384.0 (3.0)          |
| 512 | 173.3 | 187.0394 | 3102.2      | .5        | 95.1        | 484.0 (3.7)          |

### test_7_8k

Buffer cache size 1024/num_cores

| Tgt CPUs    | QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-------------|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 16 (0xFFFF) | 512 | 173.3 | 187.5034 | 3101.7      | .7        | 95.0        | 189.6 (1.4)          |
| 8 (0xFF)    | 512 | 112.7 | 121.2348 | 4759.4      | .4        | 96.3        | 692.3 (5.4)          |
| 4 (0xF)     | 512 | 51.8  | 58.1528  | 10351.5     | .2        | 96.1        | 597.3 (4.6)          |
| 2 (0x3)     | 512 | 21.3  | 23.0764  | 25103.5     | 0         | 88.7        | 1024.0 (8.0)         |
| 1 (0x1)     | 512 | 11.5  | 12.5818  | 46551.5     | 0         | 87.3        | 1024.0 (8.0)         |

### test_9_8k

Buffer cache size num_buffers/16

| Num buffers | QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-------------|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 2048        | 512 | 111.9 | 120.003  | 4796.5      | .7        | 67.7        | 546.3 (4.2)          |
| 1536        | 512 | 147.7 | 157.2425 | 3633.8      | .8        | 73.2        | 314.6 (2.4)          |
| 1280        | 512 | 172.0 | 185.9856 | 3125.6      | .7        | 86.6        | 268.3 (2.0)          |
| 1024        | 512 | 173.5 | 186.8309 | 3099.0      | .7        | 95.2        | 248.6 (1.9)          |
| 768         | 512 | 172.3 | 186.2822 | 3119.9      | .7        | 96.1        | 206.0 (1.6)          |
| 512         | 512 | 167.5 | 183.5131 | 3209.6      | .9        | 96.6        | 96.0 (.7)            |
| 256         | 512 | 157.4 | 172.9373 | 3409.2      | .6        | 96.8        | 47.3 (.3)            |
| 128         | 512 | 117.3 | 128.8741 | 4575.9      | .5        | 96.9        | 36.6 (.2)            |

### test_13_8k

| Disk type        | QD | BW  | WIRE BW | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|------------------|----|-----|---------|-------------|-----------|-------------|----------------------|
| Null             | 1  | 5.3 | 6.8275  | 12.0        | 1.2       | 91.6        | 0 (0)                |
| NVMe             | 1  | 1.2 | 1.5776  | 52.6        | .2        | 99.5        | 0 (0)                |
| NVMe+split       | 1  | 1.2 | 1.5329  | 53.6        | .2        | 99.5        | 0 (0)                |
| NVMe+split+delay | 1  | 0   | 0.0666  | 1130.0      | 0         | 99.7        | 0 (0)                |

### test_14_8k

CPU mask , num cores 16, credit size 32768, num buffers 131072, buf cache 8192

| Pacer period | QD   | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) | Pacer period, us |
|--------------|------|-------|----------|-------------|-----------|-------------|----------------------|------------------|
| 1425         | 256  | 146.3 | 158.9674 | 1834.3      | .6        | 96.5        | 143.3 (1.1)          | 29.4             |
| 1425         | 2048 | 147.1 | 158.9499 | 4293.5      | .7        | 96.5        | 160.0 (1.2)          | 30.1             |
| 1500         | 256  | 147.2 | 161.6531 | 1822.5      | .6        | 96.5        | 143.6 (1.1)          | 29.2             |
| 1500         | 2048 | 147.1 | 158.8686 | 4286.1      | .6        | 96.5        | 166.0 (1.2)          | 30.2             |

CPU mask , num cores 16, credit size 65536, num buffers 131072, buf cache 8192

| Pacer period | QD   | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) | Pacer period, us |
|--------------|------|-------|----------|-------------|-----------|-------------|----------------------|------------------|
| 2850         | 256  | 173.6 | 194.5237 | 1545.7      | 1.0       | 90.7        | 76.6 (.5)            | 59.3             |
| 2850         | 2048 | 170.9 | 194.4597 | 4036.7      | 1.3       | 95.8        | 212.3 (1.6)          | 59.3             |
| 3000         | 256  | 167.9 | 186.3242 | 1597.7      | .7        | 96.4        | 78.0 (.6)            | 59.9             |
| 3000         | 2048 | 170.9 | 186.1337 | 3917.3      | .7        | 96.2        | 241.0 (1.8)          | 59.7             |

## 16k payload

### test_2_16k

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 180.6 | 193.4267 | 370.9       | .7        | 91.1        | 172.0 (1.3)          |
| 64  | 178.8 | 190.7625 | 749.9       | .7        | 36.4        | 474.0 (3.7)          |
| 128 | 170.8 | 183.5446 | 1570.6      | .5        | 17.3        | 2414.0 (18.8)        |
| 256 | 168.0 | 182.9341 | 3194.8      | .5        | 18.6        | 2553.3 (19.9)        |
| 512 | 167.1 | 180.7195 | 6422.6      | .6        | 18.3        | 2642.6 (20.6)        |

### test_3_16k

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 180.7 | 193.5619 | 370.8       | .7        | 95.1        | 344.0 (2.6)          |
| 64  | 132.2 | 141.3504 | 1014.6      | .6        | 68.0        | 892.0 (6.9)          |
| 128 | 112.7 | 124.0101 | 2379.5      | .6        | 61.0        | 2308.0 (18.0)        |
| 256 | 110.6 | 120.1659 | 4850.7      | .6        | 62.5        | 2486.0 (19.4)        |
| 512 | 106.7 | 118.0524 | 10060.0     | .4        | 59.4        | 2596.6 (20.2)        |

### test_4_16k

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 180.6 | 193.3482 | 371.1       | .7        | 95.6        | 328.0 (2.5)          |
| 64  | 180.0 | 192.6089 | 745.3       | .6        | 95.4        | 369.3 (2.8)          |
| 128 | 179.2 | 191.6621 | 1497.3      | .6        | 95.2        | 410.6 (3.2)          |
| 256 | 178.8 | 191.1941 | 3002.1      | .5        | 94.8        | 400.0 (3.1)          |
| 512 | 178.8 | 191.6447 | 6004.7      | .4        | 94.8        | 516.6 (4.0)          |

### test_5_16k

| QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 32  | 180.6 | 193.4753 | 371.0       | .7        | 97.9        | 166.0 (1.2)          |
| 64  | 179.9 | 192.4745 | 745.6       | .6        | 97.7        | 364.0 (2.8)          |
| 128 | 179.3 | 192.3458 | 1496.7      | .6        | 97.6        | 426.6 (3.3)          |
| 256 | 178.8 | 191.4797 | 3002.8      | .6        | 97.5        | 425.3 (3.3)          |
| 512 | 178.5 | 191.1763 | 6016.1      | .5        | 97.4        | 609.3 (4.7)          |

### test_7_16k

Buffer cache size 1024/num_cores

| Tgt CPUs    | QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-------------|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 16 (0xFFFF) | 512 | 178.5 | 190.9962 | 6012.8      | .7        | 97.5        | 234.6 (1.8)          |
| 8 (0xFF)    | 512 | 178.0 | 190.8231 | 6030.2      | .1        | 97.3        | 636.6 (4.9)          |
| 4 (0xF)     | 512 | 102.6 | 112.9581 | 10461.8     | .4        | 97.6        | 597.3 (4.6)          |
| 2 (0x3)     | 512 | 41.7  | 44.5092  | 25707.1     | .2        | 94.1        | 1024.0 (8.0)         |
| 1 (0x1)     | 512 | 22.7  | 24.3459  | 47163.2     | .1        | 93.3        | 1024.0 (8.0)         |

### test_9_16k

Buffer cache size num_buffers/16

| Num buffers | QD  | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|-------------|-----|-------|----------|-------------|-----------|-------------|----------------------|
| 2048        | 512 | 120.1 | 130.2962 | 8935.9      | .8        | 64.8        | 513.3 (4.0)          |
| 1536        | 512 | 165.3 | 176.8659 | 6493.4      | .8        | 80.7        | 480.0 (3.7)          |
| 1280        | 512 | 178.8 | 191.3959 | 6003.9      | .7        | 92.6        | 334.0 (2.6)          |
| 1024        | 512 | 178.6 | 190.9651 | 6013.6      | .7        | 97.6        | 277.3 (2.1)          |
| 768         | 512 | 178.3 | 191.2801 | 6023.4      | .7        | 98.0        | 176.0 (1.3)          |
| 512         | 512 | 177.3 | 189.7078 | 6057.2      | .7        | 98.1        | 105.3 (.8)           |
| 256         | 512 | 174.9 | 189.127  | 6135.4      | .7        | 98.2        | 56.6 (.4)            |
| 128         | 512 | 130.3 | 142.5365 | 8233.6      | .5        | 98.3        | 31.3 (.2)            |

### test_13_16k

| Disk type        | QD | BW   | WIRE BW | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) |
|------------------|----|------|---------|-------------|-----------|-------------|----------------------|
| Null             | 1  | 10.1 | 12.654  | 12.6        | 2.2       | 94.9        | 0 (0)                |
| NVMe             | 1  | 2.2  | 2.8872  | 56.9        | .5        | 99.5        | 0 (0)                |
| NVMe+split       | 1  | 2.2  | 2.8077  | 57.5        | .5        | 99.6        | 0 (0)                |
| NVMe+split+delay | 1  | .1   | 0.1317  | 1143.2      | 0         | 99.6        | 0 (0)                |

### test_14_16k

CPU mask 0xFFFF, num cores 16, credit size 32768, num buffers 131072, buf cache 8192

| Pacer period | QD   | BW    | WIRE BW  | AVG LAT, us | BW STDDEV | L3 Hit Rate | Bufs in-flight (MiB) | Pacer period, us |
|--------------|------|-------|----------|-------------|-----------|-------------|----------------------|------------------|
| 1425         | 128  | 179.0 | 191.6371 | 1499.0      | .6        | 98.0        | 169.3 (1.3)          | 24.5             |
| 1425         | 1024 | 179.6 | 194.2285 | 7135.3      | .6        | 97.9        | 165.3 (1.2)          | 24.8             |
| 1500         | 128  | 169.4 | 184.844  | 1584.2      | .8        | 98.0        | 146.0 (1.1)          | 25.9             |
| 1500         | 1024 | 171.1 | 184.6484 | 7803.7      | .5        | 97.9        | 148.6 (1.1)          | 26.1             |
